"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_utils=_interopRequireDefault(require("../../tools/utils")),_dom=_interopRequireDefault(require("../../tools/dom"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var cellType="footer";function mergeFooterMethod(e,t,l){for(var o=0;o<e.length;o++){var r=e[o],n=r.row,i=r.col,a=r.rowspan,r=r.colspan;if(-1<i&&-1<n&&a&&r){if(n===t&&i===l)return{rowspan:a,colspan:r};if(n<=t&&t<n+a&&i<=l&&l<i+r)return{rowspan:0,colspan:0}}}}var _default={name:"VxeTableFooter",props:{footerTableData:Array,tableColumn:Array,fixedColumn:Array,fixedType:String,size:String},mounted:function(){var e=this.$parent,t=this.$el,l=this.$refs,o=this.fixedType,e=e.elemStore,o="".concat(o||"main","-footer-");e["".concat(o,"wrapper")]=t,e["".concat(o,"table")]=l.table,e["".concat(o,"colgroup")]=l.colgroup,e["".concat(o,"list")]=l.tfoot,e["".concat(o,"xSpace")]=l.xSpace},destroyed:function(){var e=this.$parent,t=this.fixedType,e=e.elemStore,t="".concat(t||"main","-footer-");e["".concat(t,"wrapper")]=null,e["".concat(t,"table")]=null,e["".concat(t,"colgroup")]=null,e["".concat(t,"list")]=null,e["".concat(t,"xSpace")]=null},render:function(h){var e=this._e,w=this.$parent,T=this.fixedType,t=this.fixedColumn,$=this.tableColumn,C=this.footerTableData,S=w.$listeners,l=w.tId,o=w.footerRowClassName,I=w.footerCellClassName,r=w.footerRowStyle,F=w.footerCellStyle,L=w.footerAlign,P=w.mergeFooterList,k=w.footerSpanMethod,E=w.align,O=w.scrollXLoad,q=w.columnKey,D=w.columnOpts,U=w.showFooterOverflow,A=w.currentColumn,R=w.overflowX,n=w.scrollbarWidth,M=w.tooltipOpts,i=w.visibleColumn;return T&&($=!O&&!U||P.length&&k?i:t),h("div",{class:["vxe-table--footer-wrapper",T?"fixed-".concat(T,"--wrapper"):"body--wrapper"],attrs:{xid:l},on:{scroll:this.scrollEvent}},[T?e():h("div",{class:"vxe-body--x-space",ref:"xSpace"}),h("table",{class:"vxe-table--footer",attrs:{xid:l,cellspacing:0,cellpadding:0,border:0},ref:"table"},[h("colgroup",{ref:"colgroup"},$.map(function(e,t){return h("col",{attrs:{name:e.id},key:t})}).concat(n?[h("col",{attrs:{name:"col_gutter"}})]:[])),h("tfoot",{ref:"tfoot"},C.map(function(y,b){var _=b;return h("tr",{class:["vxe-footer--row",o?_xeUtils.default.isFunction(o)?o({$table:w,_rowIndex:b,$rowIndex:_,fixed:T,type:cellType}):o:""],style:r?_xeUtils.default.isFunction(r)?r({$table:w,_rowIndex:b,$rowIndex:_,fixed:T,type:cellType}):r:null},$.map(function(t,e){var l=t.type,o=t.showFooterOverflow,r=t.footerAlign,n=t.align,i=t.footerClassName,a=M.showAll||M.enabled,c=t.children&&t.children.length,s=T?t.fixed!==T&&!c:t.fixed&&R,u=_xeUtils.default.isUndefined(o)||_xeUtils.default.isNull(o)?U:o,f=r||n||L||E,d="ellipsis"===u,p="title"===u,x=!0===u||"tooltip"===u,c=p||x||d,o={colid:t.id},r={},n=w.getColumnIndex(t),u=w.getVTColumnIndex(t),m={$table:w,_rowIndex:b,$rowIndex:_,column:t,columnIndex:n,$columnIndex:e,_columnIndex:u,itemIndex:u,items:y,fixed:T,type:cellType,data:C};if(O&&!c&&(d=c=!0),(p||x||a)&&(r.mouseenter=function(e){p?_dom.default.updateCellTitle(e.currentTarget,t):(x||a)&&w.triggerFooterTooltipEvent(e,m)}),(x||a)&&(r.mouseleave=function(e){(x||a)&&w.handleTargetLeaveEvent(e)}),S["footer-cell-click"]&&(r.click=function(e){w.emitEvent("footer-cell-click",Object.assign({cell:e.currentTarget},m),e)}),S["footer-cell-dblclick"]&&(r.dblclick=function(e){w.emitEvent("footer-cell-dblclick",Object.assign({cell:e.currentTarget},m),e)}),P.length){n=mergeFooterMethod(P,b,u);if(n){var u=n.rowspan,v=n.colspan;if(!u||!v)return null;1<u&&(o.rowspan=u),1<v&&(o.colspan=v)}}else if(k){var g=k(m)||{},v=g.rowspan,v=void 0===v?1:v,g=g.colspan,g=void 0===g?1:g;if(!v||!g)return null;1<v&&(o.rowspan=v),1<g&&(o.colspan=g)}return h("td",{class:["vxe-footer--column",t.id,(_defineProperty(g={},"col--".concat(f),f),_defineProperty(g,"col--".concat(l),l),_defineProperty(g,"col--last",e===$.length-1),_defineProperty(g,"fixed--hidden",s),_defineProperty(g,"col--ellipsis",c),_defineProperty(g,"col--current",A===t),g),_utils.default.getClass(i,m),_utils.default.getClass(I,m)],attrs:o,style:F?_xeUtils.default.isFunction(F)?F(m):F:null,on:r,key:q||D.useKey?t.id:e},[h("div",{class:["vxe-cell",{"c--title":p,"c--tooltip":x,"c--ellipsis":d}]},t.renderFooter(h,m))])}).concat(n?[h("td",{class:"vxe-footer--gutter col--gutter"})]:[]))}))])])},methods:{scrollEvent:function(e){var t=this.$parent,l=this.fixedType,o=t.$refs,r=t.scrollXLoad,n=t.triggerScrollXEvent,i=t.lastScrollLeft,a=o.tableHeader,c=o.tableBody,s=o.tableFooter,o=o.validTip,a=a?a.$el:null,s=s?s.$el:null,c=c.$el,s=s?s.scrollLeft:0,i=s!==i;t.lastScrollLeft=s,t.lastScrollTime=Date.now(),a&&(a.scrollLeft=s),c&&(c.scrollLeft=s),r&&i&&n(e),i&&o&&o.visible&&o.updatePlacement(),t.emitEvent("scroll",{type:cellType,fixed:l,scrollTop:c.scrollTop,scrollLeft:s,isX:i,isY:!1},e)}}};exports.default=_default;